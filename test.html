<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,shrink-to-fit=no"
    />
    <meta name="theme-color" content="#000000" />
    <title>React - Web Share API</title>
    <style>
      body {
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        text-align: center;
      }
      #app {
        display: flex;
        flex-grow: 1;
      }
    </style>
    <link href="https://covid19-tracker.surge.sh/" rel="canonical" />
  </head>
  <body>
    <h1>Demo</h1>
    <button class="share-btn">Share It</button>

    <script>
      if (navigator.share) {
        alert("Share available.");

        const shareBtn = document.querySelector(".share-btn");
        const ogBtnContent = shareBtn.textContent;
        const title = document.querySelector("h1").textContent;
        const url =
          (document.querySelector("link[rel=canonical]") &&
            document.querySelector("link[rel=canonical]").href) ||
          window.location.href;

        alert("url::", url);

        shareBtn.addEventListener("click", () => {
          alert("Share BTN Clicked");
          if (navigator.share) {
            navigator
              .share({
                title: "Covid19 Tracker",
                text:
                  "A dashboard which shows the covid19 stats, developed using reactjs.",
                url: "https://covid19-tracker.surge.sh/"
              })
              .then(() => {
                showMessage(shareBtn, "Thanks! 😄");
              })
              .catch((err) => {
                showMessage(shareBtn, `Couldn't share 🙁`);
              });
          } else {
            showMessage(shareBtn, "Not supported 🙅‍");
          }
        });
      } else {
        alert("Share not available.");
      }

      function showMessage(element, msg) {
        element.textContent = msg;
        setTimeout(() => {
          element.textContent = ogBtnContent;
        }, 2000);
      }
    </script>
  </body>
</html>
